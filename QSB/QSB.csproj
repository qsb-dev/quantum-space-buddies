<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <AssemblyTitle>Quantum Space Buddies</AssemblyTitle>
    <Description>Multiplayer mod for Outer Wilds</Description>
    <Product>Quantum Space Buddies</Product>
    <RunPostBuildEvent>OnBuildSuccess</RunPostBuildEvent>
    <ProjectGuid>{1F00090A-C697-4C55-B401-192F3CFB9DC2}</ProjectGuid>
    <OutputPath Condition="Exists($(OwmlDir))">$(OwmlDir)\Mods\QSB</OutputPath>
    <NoWarn>CS1998;CS0649</NoWarn>
  </PropertyGroup>
  <Target Name="weave qsb" BeforeTargets="PostBuildEvent">
    <Exec Command="&quot;$(SolutionDir)\MirrorWeaver\bin\$(Configuration)\MirrorWeaver&quot; &quot;$(OutputPath)\QSB.dll&quot; &quot;$(SolutionDir)\UnityEngine&quot;" />
  </Target>
  <PropertyGroup>
    <PostBuildEvent Condition="Exists($(UnityAssetsDir)) and Exists($(GameDir)) and Exists($(OwmlDir))">
		copy /y "$(OutputPath)\*.dll" "$(UnityAssetsDir)"
		copy /y "$(GameDir)\OuterWilds_Data\Managed\Assembly-CSharp-firstpass.dll" "$(UnityAssetsDir)"
		copy /y "$(GameDir)\OuterWilds_Data\Managed\Unity.InputSystem.dll" "$(UnityAssetsDir)"
		copy /y "$(GameDir)\OuterWilds_Data\Managed\UnityEngine.UI.dll" "$(UnityAssetsDir)"
		copy /y "$(GameDir)\OuterWilds_Data\Managed\EOS-SDK.dll" "$(UnityAssetsDir)"
		copy /y "$(GameDir)\OuterWilds_Data\Managed\UniSense.dll" "$(UnityAssetsDir)"
		copy /y "$(OwmlDir)\Autofac.dll" "$(UnityAssetsDir)"
		copy /y "$(OwmlDir)\Newtonsoft.Json.dll" "$(UnityAssetsDir)"
		copy /y "$(OwmlDir)\0Harmony.dll" "$(UnityAssetsDir)"
		copy /y "$(OwmlDir)\MonoMod.*.dll" "$(UnityAssetsDir)"
		copy /y "$(OwmlDir)\Mono.Cecil*.dll" "$(UnityAssetsDir)"
		copy /y "$(OwmlDir)\OWML.*.dll" "$(UnityAssetsDir)"
		copy /y "$(OwmlDir)\NAudio-Unity.dll" "$(UnityAssetsDir)"
	</PostBuildEvent>
  </PropertyGroup>
  <ItemGroup>
    <None Include="default-config.json">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
    <None Include="manifest.json">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
  </ItemGroup>
  <ItemGroup>
    <PackageReference Include="OuterWildsGameLibs" Version="1.1.12.125" IncludeAssets="compile" />
    <Reference Include="..\Mirror\*.dll" />
    <Reference Include="..\UniTask\*.dll" />
    <ProjectReference Include="..\FizzyFacepunch\FizzyFacepunch.csproj" />
    <ProjectReference Include="..\QSBPatcher\QSBPatcher.csproj" />
    <ProjectReference Include="..\MirrorWeaver\MirrorWeaver.csproj" ReferenceOutputAssembly="false" />
    <PackageReference Include="HarmonyX" Version="2.8.0" IncludeAssets="compile" />
    <PackageReference Include="OWML" Version="2.3.1" IncludeAssets="compile" />
  </ItemGroup>
  <ItemGroup>
    <None Update="AssetBundles\*">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
  </ItemGroup>
  <ItemGroup>
    <None Update="debugsettings.json">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
  </ItemGroup>
</Project>
